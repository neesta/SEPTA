!function(){"use strict";function t(t){var s=document.location.hash,a=s.split("#")[1];s!=i&&""!=s&&($(".select-destination").val(a),$(".destinationTxt").html(a),i=n(a)),document.title="SEPTA "+i+" Station Rundown",c=t;var o=0,l=[];$.each(c,function(t,n){var s=n.dest;if(s===i){o++;var a="<div class='col-xs-12 col-md-6'>"+e(n,t)+"</div>";l.push(a),console.log(l)}}),o>=1?($("#ajax").html(l),$.each(c,function(t,e){var n=e.dest;if(n===i){var s=new google.maps.LatLng(parseFloat(e.lat),parseFloat(e.lon)),a={center:s,zoom:16},o=new google.maps.Map(document.getElementById("map-canvas"+t),a),l=new google.maps.Marker({position:s,map:o,title:"I'm here!"});l.setMap(o),google.maps.event.addDomListener(window,"resize",function(){var t=o.getCenter();google.maps.event.trigger(o,"resize"),o.setCenter(t)})}})):(output="<br><br><h5>Well it looks like there aren't any trains currently headed towards "+i+"</h5>",$("#ajax").html(output))}function e(t,e){var n="";return n+="<ul class='train'>",n+="<li><h4>Next Stop = "+t.nextstop+"</h4></li>",n+=0===t.late?"<li class='status bg-success'>The train is not late.</li>":1===t.late?"<li class='status bg-danger'>It's running "+t.late+" minute late.</li>":"<li class='status bg-danger'>It's running "+t.late+" minutes late.</li>",n+="<li><div id='map-canvas"+e+"'></div></li>",n+="</li></ul>"}function n(t){var e=t;return"Chestnut Hill West"==e?e="Chestnut H West":"Chestnut Hill East"==e&&(e="Chestnut H West"),e}const s="http://www3.septa.org/hackathon/TrainView/?callback=?",a=3e5;var o={},l=!1,i="Warminster",c=[];$.getJSON(s,o,t);var r=$.getJSON(s,function(){console.log("success")}).done(function(){console.log("second success")}).fail(function(){console.log("error")}).always(function(){console.log("complete")});r.complete(function(){console.log("second complete")}),$("#autoRefresh").change(function(){$(this).prop("checked")?(l=!0,$("label").html("Auto Refresh <span class='subtle'>- every 5 seconds</span>")):(l=!1,$("label").html("Auto Refresh"))});setInterval(function(){l&&$.getJSON(s,o,t)},a);$(".select-destination").change(function(){i=$(this).val(),document.location.hash=i,t(c)})}();