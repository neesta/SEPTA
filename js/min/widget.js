define(["jquery","gmaps"],function(t,e){"use strict";function a(a){var l=document.location.hash,i=l.split("#")[1],o=0,r="",d=[];u=a,l!=c&&""!=l&&(t(".select-destination").val(i),t(".destinationTxt").html(i),c=s(i)),document.title="SEPTA "+c+" Station Rundown",t.each(u,function(t,e){var a=e.dest;if(a===c){o++;var s="<div class='col-xs-12 col-md-6'>"+n(e,t)+"</div>";d.push(s)}}),o>=1?(t("#ajax").html(d),t.each(u,function(t,a){var n=a.dest;if(n===c){var s=new e.LatLng(parseFloat(a.lat),parseFloat(a.lon)),l={center:s,zoom:16},i=new h.Map(document.getElementById("map-canvas"+t),l),o=new google.maps.Marker({position:s,map:i,title:"I'm here!"});o.setMap(i),h.event.addDomListener(window,"resize",function(){var t=i.getCenter();h.event.trigger(i,"resize"),i.setCenter(t)})}})):(r="<br><br><h5>Well it looks like there aren't any trains currently headed towards "+c+"</h5>",t("#ajax").html(r))}function n(t,e){var a="";return a+="<ul class='train'>",a+="<li><h4>Next Stop <stromg>"+t.nextstop+"</h4></li>",a+=0===t.late?"<li class='status bg-success'>The train is not late.</li>":1===t.late?"<li class='status bg-danger'>It's running "+t.late+" minute late.</li>":"<li class='status bg-danger'>It's running "+t.late+" minutes late.</li>",a+="<li><div id='map-canvas"+e+"'></div></li>",a+="</li></ul>"}function s(t){var e=t;return"Chestnut Hill West"==e?e="Chestnut H West":"Chestnut Hill East"==e&&(e="Chestnut H West"),e}const l="http://www3.septa.org/hackathon/TrainView/?callback=?",i=3e5;var o={},r=!1,c="Warminster",u=[],h=e;t.getJSON(l,o,a),t("#autoRefresh").change(function(){t(this).prop("checked")?(r=!0,t("label").html("Auto Refresh <span class='subtle'>- every 5 seconds</span>")):(r=!1,t("label").html("Auto Refresh"))});setInterval(function(){r&&t.getJSON(l,o,a)},i);t(".select-destination").change(function(){c=t(this).val(),document.location.hash=c,console.log("display data = "+u),a(u)})});